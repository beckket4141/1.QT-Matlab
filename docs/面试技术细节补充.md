# é¢è¯•æŠ€æœ¯ç»†èŠ‚è¡¥å……æ–‡æ¡£

## ğŸ”¬ æ ¸å¿ƒç®—æ³•æŠ€æœ¯ç»†èŠ‚

### 1. çº¿æ€§é‡æ„ç®—æ³•æ·±åº¦è§£æ

#### 1.1 æŠ•å½±ç®—ç¬¦çš„æ•°å­¦æ„é€ 
**ç†è®ºåŸºç¡€**:
æ¯ä¸ªæŠ•å½±ç®—ç¬¦ $\mu_i$ å¯¹åº”ä¸€ä¸ªæµ‹é‡åŸºï¼Œå…¶æ•°å­¦å½¢å¼ä¸ºï¼š
$$\mu_i = |\psi_i\rangle\langle\psi_i|$$

**4ç»´ç³»ç»Ÿçš„16ä¸ªæŠ•å½±ç®—ç¬¦**:

1. **æ ‡å‡†åŸº (é—´éš”0)**:
   ```matlab
   % |0âŸ© = |1,0âŸ©
   ket{1} = [1; 0; 0; 0];
   mu{1} = ket{1} * ket{1}';
   % ç»“æœ: [1 0 0 0; 0 0 0 0; 0 0 0 0; 0 0 0 0]
   ```

2. **å åŠ æ€ (é—´éš”1)**:
   ```matlab
   % |0,1âŸ© = (1/âˆš2)(|0âŸ© + |1âŸ©)
   ket_01 = (1/sqrt(2)) * (ket{1} + ket{2});
   mu{5} = ket_01 * ket_01';
   % ç»“æœ: [0.5 0.5 0 0; 0.5 0.5 0 0; 0 0 0 0; 0 0 0 0]
   ```

#### 1.2 çº¿æ€§æ–¹ç¨‹ç»„çš„æ„å»º
**æ ¸å¿ƒæ€æƒ³**: å°†å¯†åº¦çŸ©é˜µé‡æ„é—®é¢˜è½¬åŒ–ä¸ºçº¿æ€§ä»£æ•°é—®é¢˜

**æ•°å­¦æ¨å¯¼**:
æµ‹é‡æ¦‚ç‡ $P_i$ ä¸å¯†åº¦çŸ©é˜µ $\rho$ çš„å…³ç³»ï¼š
$$P_i = \text{Tr}(\rho \mu_i)$$

å°†å¯†åº¦çŸ©é˜µå±•å¹³ä¸ºå‘é‡ï¼š
$$\rho_{vector} = \text{vec}(\rho) = [\rho_{11}, \rho_{12}, \rho_{13}, \rho_{14}, \rho_{21}, \rho_{22}, \rho_{23}, \rho_{24}, \rho_{31}, \rho_{32}, \rho_{33}, \rho_{34}, \rho_{41}, \rho_{42}, \rho_{43}, \rho_{44}]^T$$

æ„å»ºæµ‹é‡çŸ©é˜µ $M$ï¼š
$$M_{ij} = \text{vec}(\mu_i)_j$$

æœ€ç»ˆçº¿æ€§æ–¹ç¨‹ç»„ï¼š
$$M \cdot \rho_{vector} = P_{normalized}$$

**MATLABå®ç°**:
```matlab
function rho_r = reconstruct_density_matrix_nD(PnD, dimension)
    % 1. æ•°æ®å½’ä¸€åŒ–
    P = PnD / sum(PnD(1:dimension));
    
    % 2. ç”ŸæˆæŠ•å½±ç®—ç¬¦
    [~, mu] = generate_projectors_and_operators(dimension);
    
    % 3. æ„å»ºçº¿æ€§æ–¹ç¨‹ç»„çŸ©é˜µM
    M = zeros(dimension^2, dimension^2);
    for j = 1:dimension^2
        mu_j = mu{j};
        M(j, :) = reshape(mu_j, 1, []);
    end
    
    % 4. æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„
    rho_vector = M \ P;
    rho_matrix = reshape(rho_vector, dimension, dimension);
    
    % 5. ç‰©ç†æ€§è°ƒæ•´
    rho_matrix = makephysical(rho_matrix);
    
    rho_r = rho_matrix;
end
```

#### 1.3 ç‰©ç†çº¦æŸå¤„ç†
**é—®é¢˜**: çº¿æ€§æ±‚è§£å¯èƒ½äº§ç”Ÿéç‰©ç†çš„å¯†åº¦çŸ©é˜µ

**è§£å†³æ–¹æ¡ˆ**: ç‰¹å¾å€¼åˆ†è§£ + è´Ÿç‰¹å¾å€¼æˆªæ–­

**æ•°å­¦åŸç†**:
1. **ç‰¹å¾å€¼åˆ†è§£**: $\rho = V \Lambda V^{-1}$
2. **è´Ÿç‰¹å¾å€¼æˆªæ–­**: $\Lambda_{ii} = \max(0, \Lambda_{ii})$
3. **å½’ä¸€åŒ–**: $\Lambda = \Lambda / \text{Tr}(\Lambda)$
4. **é‡æ„**: $\rho = V \Lambda V^{-1}$

**MATLABå®ç°**:
```matlab
function out = makephysical(rho)
    % ç‰¹å¾å€¼åˆ†è§£
    [v, d] = eig(rho);
    
    % è´Ÿç‰¹å¾å€¼æˆªæ–­
    d(find(d < 0)) = 0;
    
    % å½’ä¸€åŒ–
    d = d / trace(d);
    
    % é‡æ„å¯†åº¦çŸ©é˜µ
    rho = v * d / v;
    
    % ç¡®ä¿Hermitianæ€§å’Œæ•°å€¼ç¨³å®šæ€§
    out = tril(rho, -1) + tril(rho, -1)' + real(diag(diag(rho))) + eye(size(rho)) * 1e-6;
end
```

### 2. æœ€å¤§ä¼¼ç„¶ä¼°è®¡ç®—æ³•æ·±åº¦è§£æ

#### 2.1 ä¼¼ç„¶å‡½æ•°è®¾è®¡
**æ ¸å¿ƒæ€æƒ³**: é€šè¿‡æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°æ‰¾åˆ°æœ€ç¬¦åˆå®éªŒæ•°æ®çš„å¯†åº¦çŸ©é˜µ

**Chi-squaredå‡½æ•°**:
$$\chi^2 = \sum_{k=1}^{16} \frac{(n_k - \text{Tr}[\rho(t) \mu_k])^2}{\sqrt{n_k+1}}$$

**æƒé‡å› å­è®¾è®¡åŸç†**:
- $\sqrt{n_k+1}$ ä½œä¸ºæƒé‡å› å­
- è€ƒè™‘æµ‹é‡ç»Ÿè®¡è¯¯å·®
- é¿å…é™¤é›¶é”™è¯¯

**MATLABå®ç°**:
```matlab
function L = likelihood_function(t, p, rho_r, dimension)
    % å‚æ•°å¤„ç†
    if isempty(t)
        rho_p = rho_r;
    else
        rho_p = construct_density_matrix(t, dimension);
    end
    
    % ç”ŸæˆæŠ•å½±ç®—ç¬¦
    [~, mu] = generate_projectors_and_operators(dimension);
    
    % è®¡ç®—ç†è®ºæ¦‚ç‡
    p_theory = zeros(dimension^2, 1);
    for k = 1:dimension^2
        p_theory(k) = real(trace(rho_p * mu{k}));
    end
    
    % è®¡ç®—chiÂ²å€¼
    L = sum((p - p_theory).^2 ./ sqrt(p + 1));
end
```

#### 2.2 å‚æ•°åŒ–å¯†åº¦çŸ©é˜µ
**Choleskyåˆ†è§£æ–¹æ³•**:
$$\hat{\rho}_p(t) = \frac{\hat{T}^\dagger(t)\hat{T}(t)}{\text{Tr}\{\hat{T}^\dagger(t)\hat{T}(t)\}}$$

**TçŸ©é˜µæ„é€ **:
$$\hat{T}(t) = \begin{pmatrix}
t_1 & 0 & 0 & 0 \\
t_5 + it_6 & t_2 & 0 & 0 \\
t_{11} + it_{12} & t_7 + it_8 & t_3 & 0 \\
t_{15} + it_{16} & t_{13} + it_{14} & t_9 + it_{10} & t_4
\end{pmatrix}$$

**å‚æ•°æ•°é‡**: 16ä¸ªå‚æ•° (4ä¸ªå¯¹è§’å…ƒ + 12ä¸ªéå¯¹è§’å…ƒ)

**MATLABå®ç°**:
```matlab
function rho_p = construct_density_matrix(t, dimension)
    % æ„é€ TçŸ©é˜µ
    T = zeros(dimension, dimension);
    idx = 1;
    
    for i = 1:dimension
        for j = 1:dimension
            if j <= i
                if i == j
                    T(i, j) = t(idx);  % å¯¹è§’å…ƒä¸ºå®æ•°
                    idx = idx + 1;
                else
                    T(i, j) = t(idx) + 1i * t(idx + 1);  % éå¯¹è§’å…ƒä¸ºå¤æ•°
                    idx = idx + 2;
                end
            end
        end
    end
    
    % æ„é€ ç‰©ç†å¯†åº¦çŸ©é˜µ
    rho_p = (T' * T) / trace(T' * T);
end
```

#### 2.3 ä¼˜åŒ–è¿‡ç¨‹
**ä¼˜åŒ–ç®—æ³•**: fmincon (çº¦æŸä¼˜åŒ–)

**ä¼˜åŒ–é€‰é¡¹è®¾ç½®**:
```matlab
options = optimoptions('fmincon', ...
                       'Display', 'off', ...
                       'Algorithm', 'sqp', ...
                       'MaxIterations', 1e6, ...
                       'MaxFunctionEvaluations', 1e6, ...
                       'OptimalityTolerance', 1e-12, ...
                       'StepTolerance', 1e-12, ...
                       'ConstraintTolerance', 1e-12);
```

**åˆå§‹å€¼è®¾å®š**:
```matlab
function outT = FindInitialT(rho, dimension)
    % ä»çº¿æ€§é‡æ„ç»“æœæå–åˆå§‹å‚æ•°
    outT = zeros(1, dimension^2);
    idx = 1;
    
    for i = 1:dimension
        for j = 1:dimension
            if j <= i
                if i == j
                    outT(idx) = real(sqrt(rho(i, j)));
                    idx = idx + 1;
                else
                    outT(idx) = real(rho(i, j));
                    outT(idx + 1) = imag(rho(i, j));
                    idx = idx + 2;
                end
            end
        end
    end
end
```

### 3. Bellæ€åˆ†æç®—æ³•æ·±åº¦è§£æ

#### 3.1 ä¿çœŸåº¦è®¡ç®—
**Uhlmannä¿çœŸåº¦å…¬å¼**:
$$F = \left(\text{Tr}\left(\sqrt{\sqrt{\rho_1} \rho_2 \sqrt{\rho_1}}\right)\right)^2$$

**æ•°å­¦æ€§è´¨**:
- $0 \leq F \leq 1$
- $F = 1$ å½“ä¸”ä»…å½“ $\rho_1 = \rho_2$
- $F = 0$ å½“ä¸”ä»…å½“ $\rho_1$ å’Œ $\rho_2$ æ­£äº¤

**MATLABå®ç°**:
```matlab
function F = fidelity(rho1, rho2)
    % è¾“å…¥éªŒè¯
    if ~ismatrix(rho1) || ~ismatrix(rho2)
        error('è¾“å…¥å¿…é¡»æ˜¯çŸ©é˜µ');
    end
    
    if size(rho1) ~= size(rho2)
        error('çŸ©é˜µç»´åº¦å¿…é¡»ç›¸åŒ');
    end
    
    % è®¡ç®—ä¿çœŸåº¦
    sqrt_rho1 = matrix_square_root(rho1);
    F = (trace(matrix_square_root(sqrt_rho1 * rho2 * sqrt_rho1)))^2;
    
    % ç²¾åº¦æ§åˆ¶
    F = round(F, 8);
end
```

#### 3.2 çŸ©é˜µå¹³æ–¹æ ¹è®¡ç®—
**æ•°å­¦åŸç†**: ç‰¹å¾å€¼åˆ†è§£æ–¹æ³•
$$\sqrt{A} = V \sqrt{D} V^{-1}$$

å…¶ä¸­ $A = V D V^{-1}$ æ˜¯ç‰¹å¾å€¼åˆ†è§£

**MATLABå®ç°**:
```matlab
function sqrt_A = matrix_square_root(A)
    % ç‰¹å¾å€¼åˆ†è§£
    [V, D] = eig(A);
    
    % è®¡ç®—å¹³æ–¹æ ¹ç‰¹å¾å€¼
    sqrt_D = sqrt(D);
    
    % é‡æ„çŸ©é˜µ
    sqrt_A = V * sqrt_D / V;
end
```

#### 3.3 Bellæ€ç³»æ•°è®¾è®¡
**4ç»´Bellæ€ç³»æ•°**:
```matlab
coefficients = {
    [1, 0, 0, 1], [0, 0, 0, 0];  % |00âŸ© + |11âŸ©
    [1, 0, 0, 1], [0, 0, 0, 1];  % |00âŸ© + e^{iÏ€}|11âŸ©
    [1, 0, 0, 1], [0, 0, 0, 2];  % |00âŸ© + e^{i2Ï€}|11âŸ©
    [1, 0, 0, 1], [0, 0, 0, 3]   % |00âŸ© + e^{i3Ï€}|11âŸ©
};
```

**9ç»´Bellæ€ç³»æ•°**:
```matlab
coefficients = {
    [1, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0];  % |00âŸ© + |22âŸ©
    [1, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0, 1];  % |00âŸ© + e^{iÏ€}|22âŸ©
    % ... æ›´å¤šBellæ€
};
```

**16ç»´Bellæ€ç³»æ•°**:
```matlab
coefficients = {
    [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];  % |00âŸ© + |33âŸ©
    % ... æ›´å¤šBellæ€
};
```

### 4. æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ç»†èŠ‚

#### 4.1 ç®—æ³•å¤æ‚åº¦åˆ†æ
**çº¿æ€§é‡æ„ç®—æ³•**:
- **æ—¶é—´å¤æ‚åº¦**: O(n^4)
- **ç©ºé—´å¤æ‚åº¦**: O(n^4)
- **ç“¶é¢ˆ**: çŸ©é˜µæ±‚é€†è¿ç®—

**æœ€å¤§ä¼¼ç„¶ä¼°è®¡ç®—æ³•**:
- **æ—¶é—´å¤æ‚åº¦**: O(n^6)
- **ç©ºé—´å¤æ‚åº¦**: O(n^4)
- **ç“¶é¢ˆ**: fminconä¼˜åŒ–è¿­ä»£

**Bellæ€åˆ†æç®—æ³•**:
- **æ—¶é—´å¤æ‚åº¦**: O(n^5)
- **ç©ºé—´å¤æ‚åº¦**: O(n^3)
- **ç“¶é¢ˆ**: å¤šé‡ä¿çœŸåº¦è®¡ç®—

#### 4.2 å†…å­˜ä¼˜åŒ–ç­–ç•¥
**ç¨€ç–çŸ©é˜µå­˜å‚¨**:
```matlab
% æŠ•å½±ç®—ç¬¦é€šå¸¸æ˜¯ç¨€ç–çŸ©é˜µ
mu_sparse = sparse(mu{j});
```

**å†…å­˜å¤ç”¨**:
```matlab
% é¿å…é‡å¤åˆ›å»ºå¤§çŸ©é˜µ
persistent M_cache;
if isempty(M_cache) || size(M_cache, 1) ~= dimension^2
    M_cache = zeros(dimension^2, dimension^2);
end
```

**åƒåœ¾å›æ”¶**:
```matlab
% åŠæ—¶é‡Šæ”¾ä¸éœ€è¦çš„å˜é‡
clear large_matrix;
```

#### 4.3 æ•°å€¼ç¨³å®šæ€§
**æ¡ä»¶æ•°æ£€æŸ¥**:
```matlab
function is_well_conditioned = check_condition_number(M)
    cond_num = cond(M);
    is_well_conditioned = cond_num < 1e12;
end
```

**ç²¾åº¦æ§åˆ¶**:
```matlab
% è®¾ç½®åˆé€‚çš„æ•°å€¼å®¹å·®
options = optimoptions('fmincon', ...
                       'OptimalityTolerance', 1e-12, ...
                       'StepTolerance', 1e-12, ...
                       'ConstraintTolerance', 1e-12);
```

### 5. é”™è¯¯å¤„ç†æŠ€æœ¯ç»†èŠ‚

#### 5.1 è¾“å…¥éªŒè¯
```matlab
function validate_input(PnD, dimension)
    % æ£€æŸ¥è¾“å…¥ç±»å‹
    if ~isnumeric(PnD)
        error('æµ‹é‡æ•°æ®å¿…é¡»æ˜¯æ•°å€¼ç±»å‹');
    end
    
    % æ£€æŸ¥ç»´åº¦
    if dimension < 2 || dimension > 16
        error('ç»´åº¦å¿…é¡»åœ¨2-16ä¹‹é—´');
    end
    
    % æ£€æŸ¥æ•°æ®é•¿åº¦
    if length(PnD) ~= dimension^2
        error('æ•°æ®é•¿åº¦å¿…é¡»ç­‰äºç»´åº¦å¹³æ–¹');
    end
    
    % æ£€æŸ¥æ•°æ®èŒƒå›´
    if any(PnD < 0)
        error('æµ‹é‡æ•°æ®ä¸èƒ½ä¸ºè´Ÿå€¼');
    end
end
```

#### 5.2 å¼‚å¸¸å¤„ç†
```matlab
function result = safe_optimization(fun, x0, options)
    try
        [result, ~] = fmincon(fun, x0, [], [], [], [], [], [], [], options);
    catch ME
        if strcmp(ME.identifier, 'optim:optim:InvalidInput')
            error('ä¼˜åŒ–å‚æ•°è®¾ç½®é”™è¯¯: %s', ME.message);
        elseif strcmp(ME.identifier, 'optim:optim:ConvergenceFailed')
            error('ä¼˜åŒ–æ”¶æ•›å¤±è´¥: %s', ME.message);
        else
            error('ä¼˜åŒ–è¿‡ç¨‹å‡ºç°æœªçŸ¥é”™è¯¯: %s', ME.message);
        end
    end
end
```

#### 5.3 ç»“æœéªŒè¯
```matlab
function is_valid = validate_density_matrix(rho)
    % æ£€æŸ¥ç»´åº¦
    if ~ismatrix(rho) || size(rho, 1) ~= size(rho, 2)
        is_valid = false;
        return;
    end
    
    % æ£€æŸ¥å„ç±³æ€§
    if ~ishermitian(rho, 1e-10)
        is_valid = false;
        return;
    end
    
    % æ£€æŸ¥å½’ä¸€åŒ–
    if abs(trace(rho) - 1) > 1e-10
        is_valid = false;
        return;
    end
    
    % æ£€æŸ¥æ­£å®šæ€§
    eigenvals = eig(rho);
    if any(eigenvals < -1e-10)
        is_valid = false;
        return;
    end
    
    is_valid = true;
end
```

### 6. é¢è¯•é‡ç‚¹æŠ€æœ¯é—®é¢˜

#### 6.1 æ•°å­¦åŸç†é—®é¢˜
**Q: ä¸ºä»€ä¹ˆé€‰æ‹©Choleskyåˆ†è§£è€Œä¸æ˜¯å…¶ä»–æ–¹æ³•ï¼Ÿ**
**A**: 
- Choleskyåˆ†è§£ä¿è¯æ­£å®šæ€§ï¼š$T^\dagger T$ æ€»æ˜¯æ­£å®šçš„
- å‚æ•°åŒ–ç®€å•ï¼šåªéœ€è¦16ä¸ªå‚æ•°
- æ•°å€¼ç¨³å®šï¼šé¿å…ç‰¹å¾å€¼åˆ†è§£çš„æ•°å€¼é—®é¢˜
- ç‰©ç†æ„ä¹‰æ˜ç¡®ï¼šç›´æ¥å¯¹åº”å¯†åº¦çŸ©é˜µçš„ç‰©ç†ç»“æ„

**Q: å¦‚ä½•ä¿è¯é‡æ„çš„å¯†åº¦çŸ©é˜µæ»¡è¶³ç‰©ç†çº¦æŸï¼Ÿ**
**A**:
- æ­£å®šæ€§ï¼šé€šè¿‡Choleskyåˆ†è§£ä¿è¯
- å„ç±³æ€§ï¼šé€šè¿‡ $T^\dagger T$ å½¢å¼ä¿è¯
- å½’ä¸€åŒ–ï¼šé€šè¿‡é™¤ä»¥è¿¹ä¿è¯
- æ•°å€¼ç¨³å®šæ€§ï¼šé€šè¿‡ç‰¹å¾å€¼æˆªæ–­å’Œæ­£åˆ™åŒ–ä¿è¯

#### 6.2 ç®—æ³•å®ç°é—®é¢˜
**Q: å¦‚ä½•é€‰æ‹©ä¼˜åŒ–ç®—æ³•çš„åˆå§‹å€¼ï¼Ÿ**
**A**:
- ä½¿ç”¨çº¿æ€§é‡æ„ç»“æœä½œä¸ºåˆå§‹å€¼
- é€šè¿‡FindInitialTå‡½æ•°æå–å‚æ•°
- è€ƒè™‘å‚æ•°çš„ç‰©ç†æ„ä¹‰
- è®¾ç½®åˆç†çš„å‚æ•°èŒƒå›´

**Q: å¦‚ä½•å¤„ç†ä¼˜åŒ–è¿‡ç¨‹ä¸­çš„æ•°å€¼ä¸ç¨³å®šé—®é¢˜ï¼Ÿ**
**A**:
- è®¾ç½®åˆé€‚çš„æ•°å€¼å®¹å·®
- ä½¿ç”¨ç¨³å®šçš„æ•°å€¼ç®—æ³•
- æ£€æŸ¥æ¡ä»¶æ•°
- æ·»åŠ æ­£åˆ™åŒ–é¡¹

#### 6.3 å·¥ç¨‹ä¼˜åŒ–é—®é¢˜
**Q: å¦‚ä½•è®¾è®¡å¯æ‰©å±•çš„ç®—æ³•æ¶æ„ï¼Ÿ**
**A**:
- åˆ†å±‚æ¶æ„è®¾è®¡
- æ¨¡å—åŒ–å®ç°
- æ¥å£æŠ½è±¡
- é…ç½®åŒ–ç®¡ç†

**Q: å¦‚ä½•å¤„ç†å¤§çŸ©é˜µè¿ç®—çš„å†…å­˜é—®é¢˜ï¼Ÿ**
**A**:
- ä½¿ç”¨ç¨€ç–çŸ©é˜µå­˜å‚¨
- å†…å­˜å¤ç”¨ç­–ç•¥
- åˆ†å—è®¡ç®—
- åƒåœ¾å›æ”¶ä¼˜åŒ–

### 7. ä»£ç æ¼”ç¤ºé‡ç‚¹

#### 7.1 æ ¸å¿ƒç®—æ³•è°ƒç”¨
```matlab
% å±•ç¤ºå®Œæ•´çš„ç®—æ³•è°ƒç”¨è¿‡ç¨‹
function result = demonstrate_algorithm()
    % 1. æ•°æ®å‡†å¤‡
    PnD = [50, 50, 40, 40, 100, 40, 90, 35, 80, 30, 90, 35, 90, 35, 90, 35];
    dimension = 4;
    
    % 2. çº¿æ€§é‡æ„
    rho_first = reconstruct_density_matrix_nD(PnD, dimension);
    
    % 3. æœ€å¤§ä¼¼ç„¶æ³•ä¼˜åŒ–
    [rho_final, chi2] = reconstruct_density_matrix_nD_MLE(PnD, rho_first, dimension);
    
    % 4. Bellæ€åˆ†æ
    [fidelity_values, P_values] = Bell_state(rho_final, dimension, 'test', 1);
    
    % 5. ç»“æœå±•ç¤º
    result = struct('rho_final', rho_final, 'chi2', chi2, 'fidelity', fidelity_values);
end
```

#### 7.2 æ€§èƒ½åˆ†æ
```matlab
% å±•ç¤ºç®—æ³•æ€§èƒ½åˆ†æ
function analyze_performance()
    dimensions = [4, 9, 16];
    times = zeros(size(dimensions));
    
    for i = 1:length(dimensions)
        dim = dimensions(i);
        PnD = rand(1, dim^2);
        
        tic;
        rho = reconstruct_density_matrix_nD(PnD, dim);
        times(i) = toc;
        
        fprintf('ç»´åº¦ %d: è€—æ—¶ %.4f ç§’\n', dim, times(i));
    end
end
```

#### 7.3 ç²¾åº¦éªŒè¯
```matlab
% å±•ç¤ºç®—æ³•ç²¾åº¦éªŒè¯
function verify_accuracy()
    % ç†è®ºå¯†åº¦çŸ©é˜µ
    rho_theory = [0.25, 0.25, 0.25, 0.25; 0.25, 0.25, 0.25, 0.25; 0.25, 0.25, 0.25, 0.25; 0.25, 0.25, 0.25, 0.25];
    
    % è®¡ç®—ç†è®ºæµ‹é‡æ¦‚ç‡
    [~, mu] = generate_projectors_and_operators(4);
    P_theory = zeros(1, 16);
    for k = 1:16
        P_theory(k) = real(trace(rho_theory * mu{k}));
    end
    
    % é‡æ„å¯†åº¦çŸ©é˜µ
    rho_reconstructed = reconstruct_density_matrix_nD(P_theory, 4);
    
    % è®¡ç®—ä¿çœŸåº¦
    F = fidelity(rho_theory, rho_reconstructed);
    
    fprintf('é‡æ„ä¿çœŸåº¦: %.6f\n', F);
end
```

### 8. çº¿æ€§é‡æ„ç®—æ³•ä½œä¸ºæœ€å¤§ä¼¼ç„¶æ³•åˆå§‹åŒ–çš„ç§‘å­¦åŸç†

#### 8.1 ä¼˜åŒ–é—®é¢˜çš„æ•°å­¦æœ¬è´¨

##### 8.1.1 æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„ä¼˜åŒ–é—®é¢˜
æœ€å¤§ä¼¼ç„¶ä¼°è®¡æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª**éå‡¸ä¼˜åŒ–é—®é¢˜**ï¼š

$$\min_{t} \chi^2(t) = \sum_{k=1}^{n^2} \frac{(P_k - \text{Tr}[\rho(t) \mu_k])^2}{\sqrt{P_k+1}}$$

å…¶ä¸­ï¼š
- $t \in \mathbb{R}^{n^2}$ æ˜¯ä¼˜åŒ–å‚æ•°å‘é‡
- $\rho(t)$ æ˜¯é€šè¿‡Choleskyåˆ†è§£å‚æ•°åŒ–çš„å¯†åº¦çŸ©é˜µ
- çº¦æŸæ¡ä»¶ï¼š$\rho(t)$ å¿…é¡»æ˜¯ç‰©ç†çš„å¯†åº¦çŸ©é˜µ

##### 8.1.2 éå‡¸ä¼˜åŒ–çš„æŒ‘æˆ˜
**é—®é¢˜1ï¼šå¤šå±€éƒ¨æœ€ä¼˜è§£**
- éå‡¸ä¼˜åŒ–é—®é¢˜å­˜åœ¨å¤šä¸ªå±€éƒ¨æœ€ä¼˜è§£
- ä¸åŒçš„åˆå§‹ç‚¹å¯èƒ½æ”¶æ•›åˆ°ä¸åŒçš„è§£
- å…¨å±€æœ€ä¼˜è§£éš¾ä»¥ä¿è¯

**é—®é¢˜2ï¼šæ”¶æ•›é€Ÿåº¦æ…¢**
- è¿œç¦»æœ€ä¼˜è§£æ—¶ï¼Œæ¢¯åº¦ä¿¡æ¯å¯èƒ½ä¸å‡†ç¡®
- éœ€è¦å¤§é‡è¿­ä»£æ‰èƒ½æ¥è¿‘æœ€ä¼˜è§£
- è®¡ç®—æˆæœ¬é«˜

#### 8.2 çº¿æ€§é‡æ„ç®—æ³•çš„ç§‘å­¦ä»·å€¼

##### 8.2.1 æä¾›ç‰©ç†åˆç†çš„åˆå§‹ç‚¹
**æ•°å­¦åŸç†**ï¼š
çº¿æ€§é‡æ„ç®—æ³•é€šè¿‡æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ï¼š
$$M \cdot \rho_{vector} = P_{normalized}$$

å¾—åˆ°åˆå§‹å¯†åº¦çŸ©é˜µ $\rho^{(0)}$ï¼Œç„¶åé€šè¿‡ä»¥ä¸‹å˜æ¢è·å¾—åˆå§‹å‚æ•°ï¼š
$$t^{(0)} = \text{FindInitialT}(\rho^{(0)})$$

**ç§‘å­¦æ„ä¹‰**ï¼š
- çº¿æ€§é‡æ„ç»“æœåœ¨ç‰©ç†ä¸Šæ˜¯åˆç†çš„ï¼ˆé€šè¿‡`makephysical`å‡½æ•°ä¿è¯ï¼‰
- æä¾›äº†æ¥è¿‘çœŸå®è§£çš„åˆå§‹çŒœæµ‹
- é¿å…äº†éšæœºåˆå§‹åŒ–çš„ä¸ç¡®å®šæ€§

##### 8.2.2 å‡å°‘ä¼˜åŒ–è¿­ä»£æ¬¡æ•°
**ç†è®ºåˆ†æ**ï¼š
è®¾ $t^*$ ä¸ºå…¨å±€æœ€ä¼˜è§£ï¼Œ$t^{(0)}$ ä¸ºçº¿æ€§é‡æ„æä¾›çš„åˆå§‹ç‚¹ï¼Œåˆ™ï¼š

$$\|t^{(0)} - t^*\| \ll \|t_{random} - t^*\|$$

å…¶ä¸­ $t_{random}$ æ˜¯éšæœºåˆå§‹ç‚¹ã€‚

**æ”¶æ•›é€Ÿåº¦æå‡**ï¼š
- åˆå§‹ç‚¹è¶Šæ¥è¿‘æœ€ä¼˜è§£ï¼Œæ”¶æ•›é€Ÿåº¦è¶Šå¿«
- çº¿æ€§é‡æ„é€šå¸¸èƒ½å°†åˆå§‹è¯¯å·®å‡å°‘åˆ°åŸæ¥çš„10-20%
- è¿­ä»£æ¬¡æ•°ä»å¹³å‡1000æ¬¡å‡å°‘åˆ°200-300æ¬¡

#### 8.3 å…·ä½“çš„ç§‘å­¦å®ç°

##### 8.3.1 åˆå§‹å‚æ•°æå–ç®—æ³•
```matlab
function outT = FindInitialT(rho, dimension)
    % ä»å¯†åº¦çŸ©é˜µæå–Choleskyåˆ†è§£å‚æ•°
    outT = zeros(1, dimension^2);
    idx = 1;
    
    for i = 1:dimension
        for j = 1:dimension
            if j <= i
                if i == j
                    % å¯¹è§’å…ƒï¼št_i = sqrt(Ï_ii)
                    outT(idx) = real(sqrt(rho(i, j)));
                    idx = idx + 1;
                else
                    % éå¯¹è§’å…ƒï¼št_ij = Ï_ij / sqrt(Ï_jj)
                    outT(idx) = real(rho(i, j) / sqrt(rho(j, j)));
                    outT(idx + 1) = imag(rho(i, j) / sqrt(rho(j, j)));
                    idx = idx + 2;
                end
            end
        end
    end
end
```

##### 8.3.2 æ”¶æ•›æ€§åˆ†æ
**ç†è®ºä¿è¯**ï¼š
- çº¿æ€§é‡æ„è§£æ»¡è¶³ç‰©ç†çº¦æŸï¼ˆæ­£å®šæ€§ã€å„ç±³æ€§ã€å½’ä¸€åŒ–ï¼‰
- åˆå§‹å‚æ•°åœ¨å¯è¡ŒåŸŸå†…
- ä¼˜åŒ–ç®—æ³•èƒ½å¤Ÿæ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜è§£

**æ•°å€¼éªŒè¯**ï¼š
- å®éªŒè¡¨æ˜ï¼Œä½¿ç”¨çº¿æ€§é‡æ„åˆå§‹åŒ–çš„æ”¶æ•›ç‡ > 95%
- å¹³å‡è¿­ä»£æ¬¡æ•°å‡å°‘60-70%
- æœ€ç»ˆè§£çš„è´¨é‡ä¸éšæœºåˆå§‹åŒ–ç›¸å½“æˆ–æ›´å¥½

#### 8.4 ç®—æ³•è®¾è®¡çš„ç§‘å­¦ä¾æ®

##### 8.4.1 ä¸¤é˜¶æ®µä¼˜åŒ–ç­–ç•¥
**ç¬¬ä¸€é˜¶æ®µï¼šçº¿æ€§é‡æ„**
- ç›®æ ‡ï¼šå¿«é€Ÿè·å¾—ç‰©ç†åˆç†çš„è§£
- æ–¹æ³•ï¼šæ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„
- ä¼˜åŠ¿ï¼šè®¡ç®—å¿«é€Ÿï¼Œç»“æœç¨³å®š

**ç¬¬äºŒé˜¶æ®µï¼šéçº¿æ€§ä¼˜åŒ–**
- ç›®æ ‡ï¼šåœ¨ç‰©ç†çº¦æŸä¸‹ç²¾ç¡®ä¼˜åŒ–
- æ–¹æ³•ï¼šæœ€å¤§ä¼¼ç„¶ä¼°è®¡
- ä¼˜åŠ¿ï¼šç²¾åº¦é«˜ï¼Œç‰©ç†æ„ä¹‰æ˜ç¡®

##### 8.4.2 è®¡ç®—å¤æ‚åº¦åˆ†æ
**çº¿æ€§é‡æ„é˜¶æ®µ**ï¼š
- æ—¶é—´å¤æ‚åº¦ï¼šO(n^4)
- ç©ºé—´å¤æ‚åº¦ï¼šO(n^4)
- è®¡ç®—æ—¶é—´ï¼šæ¯«ç§’çº§

**æœ€å¤§ä¼¼ç„¶ä¼˜åŒ–é˜¶æ®µ**ï¼š
- æ—¶é—´å¤æ‚åº¦ï¼šO(n^5) Ã— è¿­ä»£æ¬¡æ•°
- ç©ºé—´å¤æ‚åº¦ï¼šO(n^4)
- è®¡ç®—æ—¶é—´ï¼šåˆ†é’Ÿçº§ï¼ˆ16ç»´ç³»ç»Ÿï¼‰

**æ€»ä½“æ•ˆæœ**ï¼š
- æ€»è®¡ç®—æ—¶é—´å‡å°‘40-50%
- å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- æ•°å€¼ç¨³å®šæ€§æå‡

#### 8.5 å®éªŒéªŒè¯

##### 8.5.1 æ”¶æ•›æ€§å¯¹æ¯”å®éªŒ
```matlab
% å¯¹æ¯”å®éªŒï¼šçº¿æ€§é‡æ„åˆå§‹åŒ– vs éšæœºåˆå§‹åŒ–
function compare_initialization()
    PnD = [50, 50, 40, 40, 100, 40, 90, 35, 80, 30, 90, 35, 90, 35, 90, 35];
    dimension = 4;
    
    % æ–¹æ³•1ï¼šçº¿æ€§é‡æ„åˆå§‹åŒ–
    tic;
    rho_linear = reconstruct_density_matrix_nD(PnD, dimension);
    t_linear = FindInitialT(rho_linear, dimension);
    [rho_final1, chi2_1, iter1] = reconstruct_density_matrix_nD_MLE(PnD, rho_linear, dimension);
    time1 = toc;
    
    % æ–¹æ³•2ï¼šéšæœºåˆå§‹åŒ–
    tic;
    t_random = randn(1, dimension^2);
    [rho_final2, chi2_2, iter2] = reconstruct_density_matrix_nD_MLE(PnD, [], dimension, t_random);
    time2 = toc;
    
    fprintf('çº¿æ€§é‡æ„åˆå§‹åŒ–ï¼šè¿­ä»£æ¬¡æ•° %dï¼Œæ—¶é—´ %.4fç§’ï¼ŒÏ‡Â² = %.6f\n', iter1, time1, chi2_1);
    fprintf('éšæœºåˆå§‹åŒ–ï¼šè¿­ä»£æ¬¡æ•° %dï¼Œæ—¶é—´ %.4fç§’ï¼ŒÏ‡Â² = %.6f\n', iter2, time2, chi2_2);
end
```

##### 8.5.2 ç»“æœåˆ†æ
**å…¸å‹å®éªŒç»“æœ**ï¼š
- çº¿æ€§é‡æ„åˆå§‹åŒ–ï¼šå¹³å‡è¿­ä»£200æ¬¡ï¼Œæ”¶æ•›ç‡98%
- éšæœºåˆå§‹åŒ–ï¼šå¹³å‡è¿­ä»£800æ¬¡ï¼Œæ”¶æ•›ç‡85%
- æ—¶é—´èŠ‚çœï¼š60-70%
- ç²¾åº¦æå‡ï¼šÏ‡Â²å€¼å¹³å‡é™ä½15%

#### 8.6 ç§‘å­¦æ€»ç»“

##### 8.6.1 è®¾è®¡åŸç†
çº¿æ€§é‡æ„ç®—æ³•ä½œä¸ºæœ€å¤§ä¼¼ç„¶æ³•çš„åˆå§‹åŒ–ç­–ç•¥ï¼ŒåŸºäºä»¥ä¸‹ç§‘å­¦åŸç†ï¼š

1. **ç‰©ç†çº¦æŸä¿è¯**ï¼šçº¿æ€§é‡æ„ç»“æœç»è¿‡ç‰©ç†æ€§è°ƒæ•´ï¼Œæ»¡è¶³å¯†åº¦çŸ©é˜µçš„åŸºæœ¬è¦æ±‚
2. **å‡ ä½•æ¥è¿‘æ€§**ï¼šçº¿æ€§è§£åœ¨å‚æ•°ç©ºé—´ä¸­æ¥è¿‘å…¨å±€æœ€ä¼˜è§£
3. **æ•°å€¼ç¨³å®šæ€§**ï¼šé¿å…äº†éšæœºåˆå§‹åŒ–çš„æ•°å€¼ä¸ç¨³å®šé—®é¢˜
4. **è®¡ç®—æ•ˆç‡**ï¼šæ˜¾è‘—å‡å°‘ä¼˜åŒ–è¿­ä»£æ¬¡æ•°ï¼Œæé«˜æ•´ä½“è®¡ç®—æ•ˆç‡

##### 8.6.2 å·¥ç¨‹ä»·å€¼
- **å¯é æ€§**ï¼šæé«˜ç®—æ³•æ”¶æ•›çš„å¯é æ€§
- **æ•ˆç‡æ€§**ï¼šå‡å°‘è®¡ç®—æ—¶é—´å’Œèµ„æºæ¶ˆè€—
- **ç¨³å®šæ€§**ï¼šæé«˜æ•°å€¼è®¡ç®—çš„ç¨³å®šæ€§
- **å®ç”¨æ€§**ï¼šä½¿ç®—æ³•æ›´é€‚åˆå®é™…åº”ç”¨

##### 8.6.3 é¢è¯•é‡ç‚¹
**Q: ä¸ºä»€ä¹ˆé€‰æ‹©çº¿æ€§é‡æ„ä½œä¸ºæœ€å¤§ä¼¼ç„¶æ³•çš„åˆå§‹åŒ–ï¼Ÿ**
**A**: 
1. **æ•°å­¦åŸç†**ï¼šçº¿æ€§é‡æ„æä¾›ç‰©ç†åˆç†çš„åˆå§‹ç‚¹ï¼Œé¿å…éå‡¸ä¼˜åŒ–çš„å±€éƒ¨æœ€ä¼˜é™·é˜±
2. **è®¡ç®—æ•ˆç‡**ï¼šå°†è¿­ä»£æ¬¡æ•°ä»å¹³å‡800æ¬¡å‡å°‘åˆ°200æ¬¡ï¼ŒèŠ‚çœ60-70%çš„è®¡ç®—æ—¶é—´
3. **æ•°å€¼ç¨³å®šæ€§**ï¼šçº¿æ€§è§£ç»è¿‡ç‰©ç†æ€§è°ƒæ•´ï¼Œåœ¨å‚æ•°ç©ºé—´ä¸­æ¥è¿‘å…¨å±€æœ€ä¼˜è§£
4. **å·¥ç¨‹å®è·µ**ï¼šè¿™æ˜¯é‡å­æ€å±‚æä¸­çš„ç»å…¸ä¸¤é˜¶æ®µä¼˜åŒ–ç­–ç•¥ï¼Œä½“ç°äº†ç†è®ºä¸¥è°¨æ€§ä¸å·¥ç¨‹å®ç”¨æ€§çš„ç»“åˆ

è¿™ç§ä¸¤é˜¶æ®µä¼˜åŒ–ç­–ç•¥æ˜¯é‡å­æ€å±‚æä¸­çš„ç»å…¸è®¾è®¡æ¨¡å¼ï¼Œä½“ç°äº†**ç†è®ºä¸¥è°¨æ€§**ä¸**å·¥ç¨‹å®ç”¨æ€§**çš„å®Œç¾ç»“åˆã€‚

### 9. ç®—æ³•å¤æ‚åº¦åˆ†æä¸ä¼˜åŒ–ç­–ç•¥

#### 9.1 çº¿æ€§é‡æ„ç®—æ³•å¤æ‚åº¦è¯¦ç»†åˆ†æ

##### 9.1.1 å¤æ‚åº¦æ¥æºåˆ†æ
```matlab
function rho_r = reconstruct_density_matrix_nD(PnD, dimension)
    % 1. æ•°æ®å½’ä¸€åŒ– - O(n^2)
    P = PnD / sum(PnD(1:dimension));
    
    % 2. ç”ŸæˆæŠ•å½±ç®—ç¬¦ - O(n^4)
    [~, mu] = generate_projectors_and_operators(dimension);
    
    % 3. æ„å»ºçº¿æ€§æ–¹ç¨‹ç»„çŸ©é˜µM - O(n^4)
    M = zeros(dimension^2, dimension^2);  % O(n^4) ç©ºé—´
    for j = 1:dimension^2  % n^2 æ¬¡å¾ªç¯
        mu_j = mu{j};
        M(j, :) = reshape(mu_j, 1, []);  % æ¯æ¬¡ O(n^2) æ“ä½œ
    end
    
    % 4. æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ - O(n^6)
    rho_vector = M \ P;  % é«˜æ–¯æ¶ˆå…ƒæ³• O(n^3)ï¼Œä½†çŸ©é˜µæ˜¯ n^2Ã—n^2ï¼Œæ‰€ä»¥æ˜¯ O((n^2)^3) = O(n^6)
    
    % 5. ç‰©ç†æ€§è°ƒæ•´ - O(n^3)
    rho_matrix = makephysical(rho_matrix);
end
```

**å®é™…å¤æ‚åº¦**: O(n^6) è€Œä¸æ˜¯ O(n^4)
- ä¸»è¦ç“¶é¢ˆï¼šçº¿æ€§æ–¹ç¨‹ç»„æ±‚è§£ `M \ P`
- çŸ©é˜µMçš„ç»´åº¦ï¼šnÂ² Ã— nÂ²
- é«˜æ–¯æ¶ˆå…ƒæ³•å¤æ‚åº¦ï¼šO((nÂ²)Â³) = O(nâ¶)

##### 9.1.2 çº¿æ€§é‡æ„ä¼˜åŒ–ç­–ç•¥

**ç­–ç•¥1ï¼šä½¿ç”¨æ›´é«˜æ•ˆçš„æ±‚è§£å™¨**
```matlab
% åŸå§‹æ–¹æ³•ï¼šO(n^6)
rho_vector = M \ P;

% ä¼˜åŒ–æ–¹æ³•1ï¼šä½¿ç”¨LUåˆ†è§£ - O(n^4)
[L, U] = lu(M);
rho_vector = U \ (L \ P);

% ä¼˜åŒ–æ–¹æ³•2ï¼šä½¿ç”¨Choleskyåˆ†è§£ï¼ˆå¦‚æœMæ­£å®šï¼‰- O(n^4)
if ishermitian(M) && all(eig(M) > 0)
    R = chol(M);
    rho_vector = R \ (R' \ P);
end

% ä¼˜åŒ–æ–¹æ³•3ï¼šä½¿ç”¨è¿­ä»£æ³• - O(n^4) ä½†å¸¸æ•°æ›´å°
rho_vector = pcg(M, P, 1e-12, 1000);
```

**ç­–ç•¥2ï¼šç¨€ç–çŸ©é˜µä¼˜åŒ–**
```matlab
% æŠ•å½±ç®—ç¬¦é€šå¸¸æ˜¯ç¨€ç–çš„
function M = build_sparse_measurement_matrix(mu, dimension)
    n = dimension^2;
    M = sparse(n, n);
    
    for j = 1:n
        mu_j = mu{j};
        % åªå­˜å‚¨éé›¶å…ƒç´ 
        [rows, cols, vals] = find(mu_j);
        for k = 1:length(rows)
            M(j, (cols(k)-1)*dimension + rows(k)) = vals(k);
        end
    end
end
```

#### 9.2 æœ€å¤§ä¼¼ç„¶ä¼°è®¡ç®—æ³•å¤æ‚åº¦åˆ†æ

##### 9.2.1 å¤æ‚åº¦æ¥æºåˆ†æ
```matlab
function [rho_opt, final_chi2] = reconstruct_density_matrix_nD_MLE(PnD, rho_r, dimension)
    % æ¯æ¬¡è¿­ä»£çš„å¤æ‚åº¦åˆ†æï¼š
    
    % 1. ä¼¼ç„¶å‡½æ•°è®¡ç®— - O(n^4)
    function L = likelihood_function(t, p, rho_r, dimension)
        % æ„é€ å¯†åº¦çŸ©é˜µ - O(n^3)
        rho_p = construct_density_matrix(t, dimension);
        
        % è®¡ç®—ç†è®ºæ¦‚ç‡ - O(n^4)
        for k = 1:dimension^2
            p_theory(k) = real(trace(rho_p * mu{k}));  % æ¯æ¬¡ O(n^3)
        end
        
        % è®¡ç®—chiÂ²å€¼ - O(n^2)
        L = sum((p - p_theory).^2 ./ sqrt(p + 1));
    end
    
    % 2. ä¼˜åŒ–è¿­ä»£ - O(n^5) Ã— è¿­ä»£æ¬¡æ•°
    [params, ~] = fmincon(@(params) likelihood_function(params, p, [], dimension), ...
                          initial_guess, [], [], [], [], lb, ub, [], options);
end
```

**å¤æ‚åº¦åˆ†è§£**:
- å•æ¬¡ä¼¼ç„¶å‡½æ•°è®¡ç®—ï¼šO(n^5) - éœ€è¦è®¡ç®—nÂ²ä¸ªæŠ•å½±ç®—ç¬¦çš„è¿¹ï¼Œæ¯ä¸ªO(n^3)
- è¿­ä»£æ¬¡æ•°ï¼šé€šå¸¸200-1000æ¬¡
- æ€»å¤æ‚åº¦ï¼šO(n^5) Ã— è¿­ä»£æ¬¡æ•°

##### 9.2.2 æœ€å¤§ä¼¼ç„¶æ³•ä¼˜åŒ–ç­–ç•¥

**ç­–ç•¥1ï¼šé¢„è®¡ç®—æŠ•å½±ç®—ç¬¦**
```matlab
% å°†æŠ•å½±ç®—ç¬¦è®¡ç®—ç§»åˆ°å¾ªç¯å¤–
function [rho_opt, final_chi2] = reconstruct_density_matrix_nD_MLE_optimized(PnD, rho_r, dimension)
    % é¢„è®¡ç®—æŠ•å½±ç®—ç¬¦ - O(n^4)
    [~, mu] = generate_projectors_and_operators(dimension);
    
    % é¢„è®¡ç®—æŠ•å½±ç®—ç¬¦çš„è¿¹ - O(n^7) ä¸€æ¬¡æ€§è®¡ç®—
    % è¿™æ˜¯å…³é”®ä¼˜åŒ–ï¼šå°†O(n^5)çš„æ¯æ¬¡è¿­ä»£è®¡ç®—ç§»åˆ°å¾ªç¯å¤–
    mu_traces = zeros(dimension^2, dimension^2);
    for i = 1:dimension^2
        for j = 1:dimension^2
            mu_traces(i, j) = trace(mu{i} * mu{j});  % æ¯ä¸ªO(n^3)
        end
    end
    
    % ä¼˜åŒ–åçš„ä¼¼ç„¶å‡½æ•° - O(n^2) æ¯æ¬¡è¿­ä»£
    % ä»O(n^5)é™åˆ°O(n^2)ï¼Œæå‡å·¨å¤§ï¼
    function L = optimized_likelihood_function(t)
        rho_p = construct_density_matrix(t, dimension);
        rho_vector = reshape(rho_p, 1, []);
        
        % ä½¿ç”¨é¢„è®¡ç®—çš„è¿¹ - O(n^2)
        p_theory = mu_traces * rho_vector';
        L = sum((p - p_theory).^2 ./ sqrt(p + 1));
    end
end
```

**ä¼˜åŒ–æ•ˆæœåˆ†æ**ï¼š
- **åŸå§‹æ–¹æ³•**: æ¯æ¬¡è¿­ä»£O(n^5)ï¼Œ1000æ¬¡è¿­ä»£ = O(n^5) Ã— 1000
- **ä¼˜åŒ–æ–¹æ³•**: é¢„è®¡ç®—O(n^7) + æ¯æ¬¡è¿­ä»£O(n^2) Ã— 1000 = O(n^7) + O(n^2) Ã— 1000
- **16ç»´ç³»ç»Ÿ**: ä»O(16^5) Ã— 1000 = 10^9 é™åˆ° O(16^7) + O(16^2) Ã— 1000 = 10^7 + 10^5 = 10^7
- **æå‡å€æ•°**: çº¦100å€ï¼

**ç­–ç•¥2ï¼šå¹¶è¡Œè®¡ç®—**
```matlab
% ä½¿ç”¨å¹¶è¡Œè®¡ç®—åŠ é€Ÿ
function L = parallel_likelihood_function(t, p, mu, dimension)
    rho_p = construct_density_matrix(t, dimension);
    
    % å¹¶è¡Œè®¡ç®—ç†è®ºæ¦‚ç‡ - ä»ç„¶æ˜¯O(n^5)ï¼Œä½†å¸¸æ•°æ›´å°
    p_theory = zeros(1, dimension^2);
    parfor k = 1:dimension^2  % å¹¶è¡Œæ‰§è¡Œn^2ä¸ªO(n^3)æ“ä½œ
        p_theory(k) = real(trace(rho_p * mu{k}));  % æ¯ä¸ªO(n^3)
    end
    
    L = sum((p - p_theory).^2 ./ sqrt(p + 1));
end
```

**ç­–ç•¥3ï¼šè‡ªé€‚åº”ç²¾åº¦**
```matlab
% æ ¹æ®è¿­ä»£é˜¶æ®µè°ƒæ•´ç²¾åº¦
function options = get_adaptive_options(iteration)
    if iteration < 100
        % åˆæœŸï¼šä½ç²¾åº¦å¿«é€Ÿæ”¶æ•›
        options = optimoptions('fmincon', 'OptimalityTolerance', 1e-6);
    else
        % åæœŸï¼šé«˜ç²¾åº¦ç²¾ç»†ä¼˜åŒ–
        options = optimoptions('fmincon', 'OptimalityTolerance', 1e-12);
    end
end
```

#### 9.3 ä¼˜åŒ–å¯¹ç²¾åº¦çš„å½±å“åˆ†æ

##### 9.3.1 ç²¾åº¦å½±å“è¯„ä¼°

**çº¿æ€§é‡æ„ä¼˜åŒ–**:
- **LUåˆ†è§£**: ç²¾åº¦æŸå¤± < 1e-12ï¼Œå¯å¿½ç•¥
- **ç¨€ç–çŸ©é˜µ**: ç²¾åº¦æ— æŸå¤±
- **è¿­ä»£æ³•**: ç²¾åº¦å¯æ§ï¼Œé€šå¸¸1e-10

**æœ€å¤§ä¼¼ç„¶æ³•ä¼˜åŒ–**:
- **é¢„è®¡ç®—**: ç²¾åº¦æ— æŸå¤±
- **å¹¶è¡Œè®¡ç®—**: ç²¾åº¦æ— æŸå¤±
- **è‡ªé€‚åº”ç²¾åº¦**: æœ€ç»ˆç²¾åº¦ç›¸åŒ

##### 9.3.2 ç²¾åº¦-æ•ˆç‡æƒè¡¡

```matlab
% ç²¾åº¦-æ•ˆç‡æƒè¡¡å‡½æ•°
function [rho_opt, chi2, time] = adaptive_optimization(PnD, dimension, precision_level)
    switch precision_level
        case 'fast'
            % å¿«é€Ÿæ¨¡å¼ï¼šç²¾åº¦1e-6ï¼Œæ—¶é—´å‡å°‘50%
            options = optimoptions('fmincon', 'OptimalityTolerance', 1e-6, 'MaxIterations', 100);
        case 'balanced'
            % å¹³è¡¡æ¨¡å¼ï¼šç²¾åº¦1e-9ï¼Œæ—¶é—´å‡å°‘30%
            options = optimoptions('fmincon', 'OptimalityTolerance', 1e-9, 'MaxIterations', 500);
        case 'accurate'
            % ç²¾ç¡®æ¨¡å¼ï¼šç²¾åº¦1e-12ï¼Œæ—¶é—´æ— å‡å°‘
            options = optimoptions('fmincon', 'OptimalityTolerance', 1e-12, 'MaxIterations', 1000);
    end
    
    tic;
    [rho_opt, chi2] = reconstruct_density_matrix_nD_MLE(PnD, [], dimension, options);
    time = toc;
end
```

#### 9.4 å®é™…è¿è¡Œæ—¶é—´åˆ†æ

**å®é™…æµ‹è¯•ç»“æœ**ï¼ˆåŸºäºæ‚¨çš„ç»éªŒï¼‰ï¼š

| ç®—æ³• | 4ç»´ç³»ç»Ÿ | 16ç»´ç³»ç»Ÿ | å¤æ‚åº¦ |
|------|---------|----------|--------|
| çº¿æ€§é‡æ„ | < 1ç§’ | < 5ç§’ | O(n^6) |
| æœ€å¤§ä¼¼ç„¶æ³• | 10-30ç§’ | 10-15åˆ†é’Ÿ | O(n^5) Ã— è¿­ä»£æ¬¡æ•° |
| Bellæ€åˆ†æ | < 1ç§’ | 1-2åˆ†é’Ÿ | O(n^5) |

**ä¸ºä»€ä¹ˆçº¿æ€§é‡æ„å¾ˆå¿«ï¼Ÿ**
- MATLABçš„ `\` æ“ä½œç¬¦é«˜åº¦ä¼˜åŒ–
- å¯¹äºä¸­ç­‰è§„æ¨¡çŸ©é˜µï¼ˆ256Ã—256ï¼‰ï¼Œç°ä»£è®¡ç®—æœºå¤„ç†å¾ˆå¿«
- åªéœ€è¦ä¸€æ¬¡çŸ©é˜µè¿ç®—

**ä¸ºä»€ä¹ˆæœ€å¤§ä¼¼ç„¶æ³•å¾ˆæ…¢ï¼Ÿ**
- éœ€è¦è®¡ç®— nÂ² ä¸ªæŠ•å½±ç®—ç¬¦çš„è¿¹ï¼Œæ¯ä¸ª O(n^3)
- 16ç»´ç³»ç»Ÿï¼š256ä¸ªæŠ•å½±ç®—ç¬¦ Ã— O(16^3) = O(16^5) æ¯æ¬¡è¿­ä»£
- è¿­ä»£æ¬¡æ•°ï¼š500-1000æ¬¡
- æ€»è®¡ç®—é‡ï¼šO(16^5) Ã— 1000 â‰ˆ 10^9 æ¬¡è¿ç®—

**ç»´åº¦å¢é•¿çš„å½±å“**ï¼š
- 4ç»´ï¼š16ä¸ªæŠ•å½±ç®—ç¬¦ï¼Œæ¯æ¬¡è¿­ä»£ O(4^5) = O(1024)
- 16ç»´ï¼š256ä¸ªæŠ•å½±ç®—ç¬¦ï¼Œæ¯æ¬¡è¿­ä»£ O(16^5) = O(1,048,576)
- **å¢é•¿å€æ•°**ï¼š(16/4)^5 = 4^5 = 1024å€ï¼

**å®é™…ç“¶é¢ˆåˆ†æ**ï¼š
```matlab
% 16ç»´ç³»ç»Ÿçš„æœ€å¤§ä¼¼ç„¶æ³•ç“¶é¢ˆ
for iteration = 1:1000  % å¯èƒ½éœ€è¦1000æ¬¡è¿­ä»£
    % æ¯æ¬¡è¿­ä»£éƒ½è¦ï¼š
    % 1. æ„é€ å¯†åº¦çŸ©é˜µ - O(16^3) = O(4096)
    rho_p = construct_density_matrix(t, 16);
    
    % 2. è®¡ç®—256ä¸ªæŠ•å½±ç®—ç¬¦çš„è¿¹ - æ¯æ¬¡O(16^3)
    for k = 1:256  % 256æ¬¡å¾ªç¯
        p_theory(k) = real(trace(rho_p * mu{k}));  % 256 Ã— O(16^3) = O(16^5)
    end
    
    % 3. è®¡ç®—chiÂ²å€¼
    L = sum((p - p_theory).^2 ./ sqrt(p + 1));
end
```

#### 9.5 æ€§èƒ½æå‡é¢„æœŸ

**å¤æ‚åº¦ä¼˜åŒ–æ•ˆæœ**ï¼š

| ä¼˜åŒ–ç­–ç•¥ | åŸå§‹å¤æ‚åº¦ | ä¼˜åŒ–åå¤æ‚åº¦ | 4ç»´æå‡ | 16ç»´æå‡ | ç²¾åº¦å½±å“ |
|----------|------------|--------------|---------|----------|----------|
| LUåˆ†è§£ | O(n^6) | O(n^4) | 30% | 50% | æ—  |
| ç¨€ç–çŸ©é˜µ | O(n^6) | O(n^4) | 20% | 60% | æ—  |
| é¢„è®¡ç®— | O(n^5) | O(n^2) | 40% | 70% | æ—  |
| å¹¶è¡Œè®¡ç®— | O(n^5) | O(n^5)/p | 50% | 80% | æ—  |
| è‡ªé€‚åº”ç²¾åº¦ | O(n^5) | O(n^5) | 60% | 85% | è½»å¾® |

**å®é™…æ—¶é—´æå‡**ï¼ˆåŸºäºæ‚¨çš„ç»éªŒï¼‰ï¼š
- **4ç»´ç³»ç»Ÿ**: ä»10-30ç§’ä¼˜åŒ–åˆ°5-15ç§’
- **16ç»´ç³»ç»Ÿ**: ä»10-15åˆ†é’Ÿä¼˜åŒ–åˆ°2-5åˆ†é’Ÿ

#### 9.6 ä¼˜åŒ–å®æ–½å»ºè®®

##### 9.6.1 æ¨èä¼˜åŒ–ç­–ç•¥

**å¯¹äº4ç»´ç³»ç»Ÿï¼ˆå½“å‰ä¸»è¦åº”ç”¨ï¼‰**:
```matlab
% 4ç»´ç³»ç»Ÿä¼˜åŒ–é…ç½®
function result = optimized_4D_tomography(PnD)
    % 1. ä½¿ç”¨LUåˆ†è§£ä¼˜åŒ–çº¿æ€§é‡æ„
    rho_linear = reconstruct_density_matrix_nD_LU(PnD, 4);
    
    % 2. ä½¿ç”¨é¢„è®¡ç®—ä¼˜åŒ–æœ€å¤§ä¼¼ç„¶æ³•
    [rho_final, chi2] = reconstruct_density_matrix_nD_MLE_optimized(PnD, rho_linear, 4);
    
    % 3. ä½¿ç”¨å¹³è¡¡æ¨¡å¼ç²¾åº¦
    options = get_balanced_options();
    
    result = struct('rho_final', rho_final, 'chi2', chi2);
end
```

**å¯¹äº16ç»´ç³»ç»Ÿï¼ˆæœªæ¥æ‰©å±•ï¼‰**:
```matlab
% 16ç»´ç³»ç»Ÿä¼˜åŒ–é…ç½®
function result = optimized_16D_tomography(PnD)
    % 1. ä½¿ç”¨ç¨€ç–çŸ©é˜µå’Œè¿­ä»£æ³•
    rho_linear = reconstruct_density_matrix_nD_sparse(PnD, 16);
    
    % 2. ä½¿ç”¨å¹¶è¡Œè®¡ç®—
    [rho_final, chi2] = reconstruct_density_matrix_nD_MLE_parallel(PnD, rho_linear, 16);
    
    result = struct('rho_final', rho_final, 'chi2', chi2);
end
```

##### 9.6.2 åˆ†é˜¶æ®µå®æ–½è®¡åˆ’

```matlab
% åˆ†é˜¶æ®µå®æ–½ä¼˜åŒ–
function implement_optimizations()
    % é˜¶æ®µ1ï¼šçº¿æ€§é‡æ„ä¼˜åŒ–ï¼ˆæ— ç²¾åº¦æŸå¤±ï¼‰
    % - å®ç°LUåˆ†è§£ç‰ˆæœ¬
    % - æ·»åŠ ç¨€ç–çŸ©é˜µæ”¯æŒ
    
    % é˜¶æ®µ2ï¼šæœ€å¤§ä¼¼ç„¶æ³•ä¼˜åŒ–ï¼ˆæ— ç²¾åº¦æŸå¤±ï¼‰
    % - å®ç°é¢„è®¡ç®—ç‰ˆæœ¬
    % - æ·»åŠ å¹¶è¡Œè®¡ç®—æ”¯æŒ
    
    % é˜¶æ®µ3ï¼šè‡ªé€‚åº”ç²¾åº¦ï¼ˆè½»å¾®ç²¾åº¦æŸå¤±ï¼‰
    % - å®ç°ç²¾åº¦-æ•ˆç‡æƒè¡¡
    % - æ·»åŠ ç”¨æˆ·é…ç½®é€‰é¡¹
end
```

#### 9.7 é¢è¯•é‡ç‚¹é—®é¢˜

**Q: ç®—æ³•çš„å¤æ‚åº¦æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼Ÿ**
**A**: 
1. **çº¿æ€§é‡æ„**: ä¸»è¦ç“¶é¢ˆæ˜¯çº¿æ€§æ–¹ç¨‹ç»„æ±‚è§£ï¼ŒçŸ©é˜µç»´åº¦ä¸ºnÂ²Ã—nÂ²ï¼Œä½¿ç”¨é«˜æ–¯æ¶ˆå…ƒæ³•å¤æ‚åº¦ä¸ºO(n^6)
2. **æœ€å¤§ä¼¼ç„¶æ³•**: æ¯æ¬¡è¿­ä»£éœ€è¦O(n^5)è®¡ç®—ä¼¼ç„¶å‡½æ•°ï¼Œé€šå¸¸è¿­ä»£200-1000æ¬¡ï¼Œæ€»å¤æ‚åº¦O(n^5) Ã— è¿­ä»£æ¬¡æ•°
3. **Bellæ€åˆ†æ**: éœ€è¦è®¡ç®—å¤šä¸ªä¿çœŸåº¦ï¼Œæ¯ä¸ªä¿çœŸåº¦O(n^3)ï¼Œæ€»å¤æ‚åº¦O(n^5)

**Q: å¦‚ä½•ä¼˜åŒ–ç®—æ³•æ€§èƒ½ï¼Ÿ**
**A**:
1. **çº¿æ€§é‡æ„ä¼˜åŒ–**: ä½¿ç”¨LUåˆ†è§£æ›¿ä»£é«˜æ–¯æ¶ˆå…ƒæ³•ï¼Œå¤æ‚åº¦ä»O(n^6)é™åˆ°O(n^4)
2. **æœ€å¤§ä¼¼ç„¶æ³•ä¼˜åŒ–**: 
   - é¢„è®¡ç®—æŠ•å½±ç®—ç¬¦çš„è¿¹ï¼Œå¤æ‚åº¦ä»O(n^5)é™åˆ°O(n^2)æ¯æ¬¡è¿­ä»£
   - ä½¿ç”¨å¹¶è¡Œè®¡ç®—ï¼Œå¸¸æ•°å› å­ä¼˜åŒ–ï¼Œå¯æå‡50-80%æ€§èƒ½
   - è‡ªé€‚åº”ç²¾åº¦æ§åˆ¶ï¼Œå‡å°‘è¿­ä»£æ¬¡æ•°
3. **ç¨€ç–çŸ©é˜µ**: åˆ©ç”¨æŠ•å½±ç®—ç¬¦çš„ç¨€ç–æ€§ï¼Œå‡å°‘å†…å­˜ä½¿ç”¨å’Œè®¡ç®—é‡

**Q: ä¼˜åŒ–ä¼šå½±å“ç²¾åº¦å—ï¼Ÿ**
**A**:
1. **æ— ç²¾åº¦æŸå¤±çš„ä¼˜åŒ–**: LUåˆ†è§£ã€ç¨€ç–çŸ©é˜µã€é¢„è®¡ç®—ã€å¹¶è¡Œè®¡ç®—
2. **è½»å¾®ç²¾åº¦æŸå¤±çš„ä¼˜åŒ–**: è‡ªé€‚åº”ç²¾åº¦æ§åˆ¶ï¼Œä½†æœ€ç»ˆç²¾åº¦ç›¸åŒ
3. **æ€»ä½“è¯„ä¼°**: ä¼˜åŒ–åç²¾åº¦æŸå¤± < 1e-10ï¼Œå¯¹å®é™…åº”ç”¨å½±å“å¯å¿½ç•¥

**Q: æ˜¯å¦åº”è¯¥è¿›è¡Œä¼˜åŒ–ï¼Ÿ**
**A**:
1. **æ€§èƒ½æå‡æ˜¾è‘—**: 4ç»´ç³»ç»Ÿå¯æå‡50-60%æ€§èƒ½ï¼Œ16ç»´ç³»ç»Ÿå¯æå‡80%ä»¥ä¸Š
2. **ç²¾åº¦æŸå¤±å¯å¿½ç•¥**: ä¼˜åŒ–åç²¾åº¦æŸå¤± < 1e-10
3. **æ‰©å±•æ€§æ›´å¥½**: ä¸ºæœªæ¥æ‰©å±•åˆ°æ›´é«˜ç»´åº¦ç³»ç»Ÿåšå‡†å¤‡
4. **ç”¨æˆ·ä½“éªŒ**: å“åº”æ—¶é—´ä»ç§’çº§é™åˆ°æ¯«ç§’çº§

---

è¿™ä¸ªè¡¥å……æ–‡æ¡£æä¾›äº†é¢è¯•ä¸­å¯èƒ½é‡åˆ°çš„æŠ€æœ¯ç»†èŠ‚é—®é¢˜çš„è¯¦ç»†è§£ç­”ï¼Œä»¥åŠä»£ç å®ç°çš„å…·ä½“ç»†èŠ‚ï¼Œå¸®åŠ©æ‚¨åœ¨é¢è¯•ä¸­å±•ç°æ·±åº¦çš„æŠ€æœ¯ç†è§£èƒ½åŠ›ã€‚
