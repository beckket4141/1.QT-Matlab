下面把“密度矩阵的秩 / 秩亏 / 特征值 / 低秩”一次说清，用定义 → 直观 → 例子 → 实验/算法含义四步走。

# 0. 密度矩阵是什么（最小公约数）

- 记作 $\rho \in \mathbb{C}^{d\times d}$，满足
   ① 厄米 $\rho^\dagger=\rho$，② 正半定 $\rho\succeq 0$，③ $\mathrm{Tr}\,\rho=1$。
- 物理含义：一个“（可能是混合的）量子态”。所有测量概率都由 Born 规则给出：$p_i=\mathrm{Tr}(\rho E_i)$。

## 补充：

### 1) “$n^2$ 个信息完备的测量”到底是什么意思？

**信息完备（IC）**的严格定义：测量集合 $\{E_i\}$ 使得映射
$$
\rho \;\mapsto\; \mathbf{p}(\rho)=\big(\mathrm{Tr}(\rho E_1),\ldots,\mathrm{Tr}(\rho E_m)\big)
$$
是**单射**（不同的 $\rho$ 产生不同的概率向量）。对 $d$-维系统，$\rho$ 有 $d^2-1$ 个自由度（实参数），所以：

- **最小信息完备**：需要**至少** $d^2$ 个结果（一个归一化约束 $\sum p_i=1$ 去掉 1 维），并且这些 $E_i$ 在 Hermitian 空间里**线性无关、张成**整个位形（简单说：设计矩阵满秩，见下）。
- 一个常见的“最小 IC”例子是 **SIC-POVM**：单设置、$m=d^2$ 个等强度秩一效应。
- 也可以用**多设置**方案（比如 $k$ 个基，每个基 $d$ 个结果，共 $kd$ 个结果）。注意每个设置有自己的归一化约束，因此**独立概率数**是 $\sum_s (m_s-1)$，要使它 $\ge d^2-1$，且对应的设计矩阵满秩才是 IC。

**实操判定（线性代数版）**：取一组迹正交的算符基 $\{B_j\}_{j=0}^{d^2-1}$（如广义泡利/格尔曼矩阵，令 $B_0=I/\sqrt d$ 其余为无迹），构造
$$
A_{ij}=\mathrm{Tr}(E_i B_j)\quad (i=1\ldots m,\; j=1\ldots d^2-1).
$$
若 $\mathrm{rank}(A)=d^2-1$ 就是信息完备。**仅有“$n^2$ 个结果”并不自动保证 IC**，还需满秩。



### 2) “样本”到底指什么？跟“很多测量基”有什么区别？（样本量和测量基量的区别）

- **两个正交维度**
  1. **广度（信息完备）**：你选了多少**测量设置/结果**，是否**信息完备（IC）**。IC 保证“理论上可辨识”，通常需要至少 $d^2$ 个线性独立的结果（并且设计矩阵满秩）。
  2. **深度（样本量/shot 数）**：在**每个设置**上你重复了多少次实验，得到多少计数。深度决定统计波动的大小（方差 $\sim 1/N$）。
- **结论**：
  - **IC 解决“能不能唯一还原”**；
  - **样本量解决“还原得多准”**。
     这两个都要足：只“多基”但每基只有几次计数=可辨识但不稳定；只“多计数”但不 IC=稳定地重建错的东西。

# 1. 特征值是什么

- 数学上：解方程 $\rho \,|\psi_i\rangle=\lambda_i |\psi_i\rangle$。

- 性质：$\lambda_i\ge 0$，$\sum_i \lambda_i=1$（因为迹为 1）。

- 物理直观：$\rho$ 可以谱分解为

  ρ=∑i=1dλi ∣ψi⟩ ⁣⟨ψi∣,\rho=\sum_{i=1}^d \lambda_i\, |\psi_i\rangle\!\langle\psi_i| ,

  这像是“以概率 $\lambda_i$”处在正交纯态 $|\psi_i\rangle$ 上的“混合”。（注意：这是**一个**正交分解；非正交纯态的分解也存在，但谱分解最直观。）

# 2. 秩（rank）是什么

- 定义：**非零特征值的个数**。记作 $\mathrm{rank}(\rho)=r$（$1\le r\le d$）。
- 三种等价直观：
  1. **最少需要几种纯态**才能写出这个混合态（在某个正交基里）？答案就是秩。
  2. $\rho$ 的**“支撑子空间”**有多大维度（$\rho$ 作用不为零的子空间维数）？
  3. $\rho$ 的信息“活跃”在一个 $r$-维子空间里，剩下 $d-r$ 维上是**完全为零权重**。
- 特例：
  - **纯态** $\rho=|\psi\rangle\langle\psi| \Rightarrow \mathrm{rank}=1$。
  - **完全混合态** $\rho=\tfrac{I}{d} \Rightarrow \mathrm{rank}=d$。

# 3. 什么是“秩亏”（rank-deficient）

在**有限样本**下，极大似然会倾向把“几乎从未观测到”的方向的概率推到**边界**（0），而**物理性约束**（正半定）又会把解推成**秩亏**。这确实会“抹掉”部分混合信息。

- **秩亏**：$\mathrm{rank}(\rho)。也就是有一些特征值**恰为 0**。
- 物理图像：这个态完全“住”在某个 $r$-维子空间里，对其正交的其他方向**概率严格为 0**。
- 实验/算法层面两个常见现象：
  - 近纯态、低温基态、受限子空间编码（比如你做 OAM×径向选了一个子空间）都天然秩亏。
  - 用 MLE 做层析时，**有限采样**容易把某些本来很小的概率“压成 0”，得到秩亏解（这会让预测对数损失发散，见第 6 点）。

# 4. 什么是“低秩”

- **低秩**：$\mathrm{rank}(\rho)=r$ 远小于维数 $d$（比如 $r\ll d$）。

- 直观：信息集中在少数本征模里，态“接近纯”。

- 量化提示：纯度 $\mathrm{Tr}(\rho^2)=\sum_i \lambda_i^2 \in [1/d,\,1]$。有不等式

  rank(ρ)  ≥  1Tr(ρ2),\mathrm{rank}(\rho)\;\ge\;\frac{1}{\mathrm{Tr}(\rho^2)} ,

  因而纯度越高（越接近 1），秩下界越小，意味着越“低秩”。

# 5. 一个一眼看懂的二能级（qubit）例子

把 $\rho$ 写成 Bloch 形式：$\rho=\frac{I+\vec r\cdot\vec\sigma}{2}$，$|\vec r|\in[0,1]$。
 其特征值：

$\lambda_{\pm}=\frac{1\pm|\vec r|}{2}.$

- $|\vec r|=1 \Rightarrow \{\lambda_+,\,\lambda_-\}=\{1,0\}$：纯态，**秩 1**。
- $0<|\vec r|<1 \Rightarrow$ 两个特征值都非零：**秩 2**。
- $|\vec r|=0 \Rightarrow \{\tfrac12,\tfrac12\}$：完全混合，**秩 2**。

# 6. 为什么“零特征值”在层析里需要当心

- **预测问题**：若某方向被估为零概率，后续观测一旦落在那上面，似然 $\log p$ 会变成 $-\infty$，导致糟糕的预测/泛化。
- **数值问题**：优化时零特征值让梯度/海森矩阵变得不稳（特别在对数似然里）。
- 工程常用解法：
  - **Hedged-MLE / 加小正则**（比如在谱上“加一点地板”），避免严格 0；
  - **PLS/投影最小二乘** 或 **eigenvalue clipping**，把微负/微零特征值投到一个小正数门槛；
  - 若物理上确实低秩，可在重建里显式利用“低秩先验”（压缩感知/核范数/秩截断），既稳又省测量。

# 7. 多体/纠缠的一个“秩”侧写

- 对**纯的双体态** $|\Psi\rangle_{AB}$，**子系统的密度矩阵秩**等于 **Schmidt 秩**。
  - 若 $\rho_A$ **满秩**，意味着 $|\Psi\rangle_{AB}$ 强纠缠（如最大纠缠给 $\rho_A=I/d$）。
  - 若 $\rho_A$ **秩 1**，说明 $|\Psi\rangle_{AB}$ 可分离（无纠缠）。

### 补充：

### 1) $\rho_A$ 与纠缠：哪些说法成立？

把两种情形分开：

**(A) 全局是纯态 $\lvert\Psi\rangle_{AB}$**

- ✅ **正确结论**：$\rho_A$ 的秩 = **Schmidt 秩**。
  - $\mathrm{rank}(\rho_A)=1 \iff$ 无纠缠（$\lvert\Psi\rangle$ 可分）。
  - $\mathrm{rank}(\rho_A)>1 \iff$ 有纠缠；秩越大至少说明“纠缠维数”越高（但“强弱”还要看谱是否更均匀——如接近最大纠缠）。

**(B) 全局是混态 $\rho_{AB}$**

- ⚠️ **满秩不等于“强纠缠”**：$\rho_A$ **满秩**既可能来自**纠缠**，也可能只是**经典混合**（与 B 没有量子纠缠）。**仅凭秩**不能判断纠缠强弱。

- ✅ **如果 $\rho_A$ 是纯的（秩 1）**：那一定有
  $$
  \rho_{AB}=\lvert\psi\rangle\langle\psi\rvert_A \otimes \rho_B,
  $$
  **没有任何相关性**（既无量子纠缠，也无经典相关），这点是严格的。

> 实操建议：判纠缠别看秩就下结论；用 **负性（negativity）/PPT、保真度到贝尔态、纠缠见证** 或 **互信息 + 本征谱** 等更可靠指标。

# 8. 和你实验最相关的两句贴士（OAM×径向）

- 你做的很多目标态本质上**近纯/低秩**（尤其在选定的 $(l,p)$ 子空间）；利用“低秩”能显著降低测量与计算成本（压缩感知/低秩 PLS）。
- 但**不要让重建出现硬 0**：哪怕物理上接近 0，也给一个小的谱底（如 $10^{-6}\sim10^{-4}$ 级），既保证可预测性又更抗噪。

------

## 一页小抄（一句话回忆）

- **特征值**：$\rho$ 在本征基里的概率权重（非负且和为 1）。
- **秩**：非零特征值个数 = 态活跃的子空间维数 = 最少需要多少纯态来拼。
- **秩亏**：秩 < 维数，某些方向概率严格 0。
- **低秩**：秩远小于维数，态接近纯；重建可用低秩先验节省资源。

如果你愿意，我可以把你当前的某个 $(l,p)$ 目标态（或实测密度矩阵）拿来算出特征值、秩、纯度、有效秩（$1/\mathrm{Tr}\rho^2$）、以及把“加谱底”/“秩截断”的效果做个对比表，直接当组会的备份页。